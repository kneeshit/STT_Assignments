diff --git a/openai/templates/chat.html b/openai/templates/chat.html
index 8bf7f00..dc395a5 100644
--- a/openai/templates/chat.html
+++ b/openai/templates/chat.html
@@ -22,7 +22,13 @@
     <link rel="preload" href="/_next/static/css/df35a37d1f08004f.css" as="style" />
     <link rel="stylesheet" href="/_next/static/css/df35a37d1f08004f.css" data-n-g="" /><noscript
         data-n-css=""></noscript>
-    <script>window.__api_prefix = '/';</script>
+    <script>
+            {% if api_prefix is defined and api_prefix != "" %}
+                window.__api_prefix = {{ api_prefix|safe }};
+            {% else %}
+                window.__api_prefix = window.location.origin;
+            {% endif %}
+    </script>
     <script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script>
     <script src="/_next/static/chunks/webpack-c08a82b5c21eeb39.js" defer=""></script>
     <script src="/_next/static/chunks/framework-e23f030857e925d4.js" defer=""></script>
@@ -65,7 +71,7 @@
         </div>
         <div class="absolute left-0 right-0 top-0 z-[2]"></div>
     </div>
-    <script id="__NEXT_DATA__" type="application/json">{{props|json_encode(pretty=true)|safe}}</script>
+    <script id="__NEXT_DATA__" type="application/json">{{props|safe}}</script>
     <script>if ('serviceWorker' in navigator) { window.addEventListener('load', function () { navigator.serviceWorker.register('/service-worker.js', { scope: '/' }).then(function (reg) { console.log('ServiceWorker registration successful with scope: ', reg.scope); }, function (e) { console.log('ServiceWorker registration failed: ', e); }); }); }</script>
 </body>
 
