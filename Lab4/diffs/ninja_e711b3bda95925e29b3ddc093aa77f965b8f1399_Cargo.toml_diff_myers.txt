diff --git a/Cargo.toml b/Cargo.toml
index c2a8031..f880edc 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -28,6 +28,13 @@ json_to_table = { version = "0.6.0", optional = true }
 tabled = { version = "0.12.2", optional = true }
 self_update = { version = "0.39.0", default-features = false, features = ["rustls", "archive-tar", "compression-flate2"] }
 
+# allocator
+tcmalloc = { version = "0.3.0", optional = true }
+snmalloc-rs = { version = "0.3.4", optional = true }
+rpmalloc = { version = "0.2.2", optional = true }
+jemallocator = { package = "tikv-jemallocator", version = "0.5.4", optional = true }
+mimalloc = { version = "0.1.39", default-features = false, optional = true }
+
 [target.'cfg(target_family = "unix")'.dependencies]
 daemonize = "0.5.0"
 nix = { version = "0.27.1", features = ["signal", "user", "ptrace"]}
@@ -35,9 +42,6 @@ nix = { version = "0.27.1", features = ["signal", "user", "ptrace"]}
 [target.'cfg(target_os = "linux")'.dependencies]
 sysctl = "0.5.4"
 
-[target.'cfg(all(any(target_arch = "x86_64", target_arch = "aarch64"), target_env = "musl"))'.dependencies]
-tikv-jemallocator = "0.5.4"
-
 [dev-dependencies]
 futures-util = "0.3.28"
 serde_json = "1.0.107"
@@ -66,6 +70,16 @@ terminal = [
     ]
 serve = ["limit"]
 limit = ["openai/limit", "openai/serve"]
+# Enable jemalloc for binaries
+jemalloc = ["jemallocator"]
+# Enable bundled tcmalloc
+tcmalloc = ["tcmalloc/bundled"]
+# Enable snmalloc for binaries
+snmalloc = ["snmalloc-rs"]
+# Enable bundled rpmalloc
+rpmalloc = ["dep:rpmalloc"]
+# Enable mimalloc for binaries
+mimalloc = ["dep:mimalloc"]
 
 [[bin]]
 name = "ninja"
