function e(){return navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")}function t(e,n,i){if(void 0===i&&(i=!0),!e.hasAttribute("x-data")||i){n(e);for(var r=e.firstElementChild;r;)t(r,n,!1),r=r.nextElementSibling}}function n(e,t,n){return void 0===n&&(n={}),new Function(["$data"].concat(Object.keys(n)),"var result; with($data) { result = "+e+" }; return result").apply(void 0,[t].concat(Object.values(n)))}function i(e){return/x-(on|bind|data|text|model|if|show|cloak|ref)/.test(e.name)}function r(e,t){return Array.from(e.attributes).filter(i).map(function(e){var t=e.name.match(/x-(on|bind|data|text|model|if|show|cloak|ref)/),n=e.name.match(/:([a-zA-Z\-]+)/),i=e.name.match(/\.[^.\]]+(?=[^\]]*$)/g)||[];return{type:t?t[1]:null,value:n?n[1]:null,modifiers:i.map(function(e){return e.replace(".","")}),expression:e.value}}).filter(function(e){return!t||e.type===name})}var o=function(e){this.el=e;var t=n(this.el.getAttribute("x-data"),{});t.$refs=this.getRefsProxy(),this.data=this.wrapDataInObservable(t),this.initialize(),this.listenForNewElementsToInitialize()};o.prototype.wrapDataInObservable=function(e){this.concernedData=[];var t=this,n=function(e){return{set:function(n,i,r){var o=e?e+"."+i:i,a=Reflect.set(n,i,r);return-1===t.concernedData.indexOf(o)&&t.concernedData.push(o),t.refresh(),a},get:function(t,i){return"object"==typeof t[i]&&null!==t[i]?new Proxy(t[i],n(e?e+"."+i:i)):t[i]}}};return new Proxy(e,n())},o.prototype.initialize=function(){var e=this;t(this.el,function(t){e.initializeElement(t)})},o.prototype.initializeElement=function(e){var t=this;r(e).forEach(function(n){var i=n.value,r=n.modifiers,o=n.expression;switch(n.type){case"on":t.registerListener(e,a=i,r,o);break;case"model":var a="select"===e.tagName.toLowerCase()||["checkbox","radio"].includes(e.type)||r.includes("lazy")?"change":"input",u=t.generateExpressionForXModelListener(e,r,o);t.registerListener(e,a,r,u);var s="value",c=t.evaluateReturnExpression(o);t.updateAttributeValue(e,s,c.output);break;case"bind":s=i;var l=t.evaluateReturnExpression(o);t.updateAttributeValue(e,s,l.output);break;case"text":var d=t.evaluateReturnExpression(o);t.updateTextValue(e,d.output);break;case"show":var p=t.evaluateReturnExpression(o);t.updateVisibility(e,p.output);break;case"if":var f=t.evaluateReturnExpression(o);t.updatePresence(e,f.output);break;case"cloak":e.removeAttribute("x-cloak")}})},o.prototype.listenForNewElementsToInitialize=function(){var e=this,t=this.el;new MutationObserver(function(t){for(var i=0;i<t.length;i++){if(!t[i].target.closest("[x-data]").isSameNode(e.el))return;if("attributes"===t[i].type&&"x-data"===t[i].attributeName){var o=n(t[i].target.getAttribute("x-data"),{});Object.keys(o).forEach(function(t){e.data[t]!==o[t]&&(e.data[t]=o[t])})}t[i].addedNodes.length>0&&t[i].addedNodes.forEach(function(t){1===t.nodeType&&(t.matches("[x-data]")||r(t).length>0&&e.initializeElement(t))})}}).observe(t,{childList:!0,attributes:!0,subtree:!0})},o.prototype.refresh=function(){var e,n,i=this,o={model:function(e){i.updateAttributeValue(e.el,"value",e.output)},bind:function(e){i.updateAttributeValue(e.el,e.attrName,e.output)},text:function(e){i.updateTextValue(e.el,e.output)},show:function(e){i.updateVisibility(e.el,e.output)},if:function(e){i.updatePresence(e.el,e.output)}};(e=function(e,n){t(e,n),i.concernedData=[]},function(){var t=this,i=arguments;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(t,i)},5)})(this.el,function(e){r(e).forEach(function(t){var n=t.type,r=t.value;if(o[n]){var a=i.evaluateReturnExpression(t.expression),u=a.output,s=a.deps;i.concernedData.filter(function(e){return s.includes(e)}).length>0&&o[n]({el:e,attrName:r,output:u})}})})},o.prototype.generateExpressionForXModelListener=function(e,t,n){var i;return i="checkbox"===e.type?Array.isArray(this.data[n])?"$event.target.checked ? "+n+".concat([$event.target.value]) : "+n+".filter(i => i !== $event.target.value)":"$event.target.checked":"select"===e.tagName.toLowerCase()&&e.multiple?t.includes("number")?"Array.from($event.target.selectedOptions).map(option => { return parseFloat(option.value || option.text) })":"Array.from($event.target.selectedOptions).map(option => { return option.value || option.text })":t.includes("number")?"parseFloat($event.target.value)":t.includes("trim")?"$event.target.value.trim()":"$event.target.value","radio"===e.type&&(e.hasAttribute("name")||e.setAttribute("name",n)),n+" = "+i},o.prototype.registerListener=function(e,t,n,i){var r=this;if(n.includes("away")){var o=function(a){e.contains(a.target)||e.offsetWidth<1&&e.offsetHeight<1||(r.runListenerHandler(i,a),n.includes("once")&&document.removeEventListener(t,o))};document.addEventListener(t,o)}else{var a=n.includes("window")?window:n.includes("document")?document:e,u=function(e){n.filter(function(e){return"window"!==e}).filter(function(e){return"document"!==e}),"keydown"===t&&modifiersWithoutWindow.length>0&&!modifiersWithoutWindow.includes(e.key.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase())||(n.includes("prevent")&&e.preventDefault(),n.includes("stop")&&e.stopPropagation(),r.runListenerHandler(i,e),n.includes("once")&&a.removeEventListener(t,u))};a.addEventListener(t,u)}},o.prototype.runListenerHandler=function(e,t){this.evaluateCommandExpression(e,{$event:t})},o.prototype.evaluateReturnExpression=function(e){var t=[],i=function(e){return{get:function(n,r){if("symbol"!=typeof r){var o=e?e+"."+r:r;return"object"!=typeof n[r]||null===n[r]||Array.isArray(n[r])?(t.push(o),n[r]):new Proxy(n[r],i(o))}}}};return{output:n(e,new Proxy(this.data,i())),deps:t}},o.prototype.evaluateCommandExpression=function(e,t){!function(e,t,n){void 0===n&&(n={}),new Function(["$data"].concat(Object.keys(n)),"with($data) { "+e+" }").apply(void 0,[t].concat(Object.values(n)))}(e,this.data,t)},o.prototype.updateTextValue=function(e,t){e.innerText=t},o.prototype.updateVisibility=function(e,t){t?1===e.style.length&&""!==e.style.display?e.removeAttribute("style"):e.style.removeProperty("display"):e.style.display="none"},o.prototype.updatePresence=function(e,t){"template"!==e.nodeName.toLowerCase()&&console.warn("Alpine: [x-if] directive should only be added to <template> tags.");var n=e.nextElementSibling&&!0===e.nextElementSibling.__x_inserted_me;if(t&&!n){var i=document.importNode(e.content,!0);e.parentElement.insertBefore(i,e.nextElementSibling),e.nextElementSibling.__x_inserted_me=!0}else!t&&n&&e.nextElementSibling.remove()},o.prototype.updateAttributeValue=function(e,t,n){if("value"===t)if("radio"===e.type)e.checked=e.value==n;else if("checkbox"===e.type)if(Array.isArray(n)){var i=!1;n.forEach(function(t){t==e.value&&(i=!0)}),e.checked=i}else e.checked=!!n;else"SELECT"===e.tagName?this.updateSelect(e,n):e.value=n;else"class"===t?Array.isArray(n)?e.setAttribute("class",n.join(" ")):Object.keys(n).forEach(function(t){n[t]?t.split(" ").forEach(function(t){return e.classList.add(t)}):t.split(" ").forEach(function(t){return e.classList.remove(t)})}):["disabled","readonly","required","checked","hidden"].includes(t)?n?e.setAttribute(t,""):e.removeAttribute(t):e.setAttribute(t,n)},o.prototype.updateSelect=function(e,t){var n=[].concat(t).map(function(e){return e+""});Array.from(e.options).forEach(function(e){e.selected=n.includes(e.value||e.text)})},o.prototype.getRefsProxy=function(){var e=this;return new Proxy({},{get:function(n,i){var r;return t(e.el,function(e){e.hasAttribute("x-ref")&&e.getAttribute("x-ref")===i&&(r=e)}),r}})};var a={start:function(){try{var t=this;function n(){t.discoverComponents(function(e){t.initializeComponent(e)}),document.addEventListener("turbolinks:load",function(){t.discoverUninitializedComponents(function(e){t.initializeComponent(e)})}),t.listenForNewUninitializedComponentsAtRunTime(function(e){t.initializeComponent(e)})}var i=function(){if(!e())return Promise.resolve(new Promise(function(e){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",e):e()})).then(function(){})}();return Promise.resolve(i&&i.then?i.then(n):n())}catch(e){return Promise.reject(e)}},discoverComponents:function(e){document.querySelectorAll("[x-data]").forEach(function(t){e(t)})},discoverUninitializedComponents:function(e){var t=document.querySelectorAll("[x-data]");Array.from(t).filter(function(e){return void 0===e.__x}).forEach(function(t){e(t)})},listenForNewUninitializedComponentsAtRunTime:function(e){var t=document.querySelector("body");new MutationObserver(function(t){for(var n=0;n<t.length;n++)t[n].addedNodes.length>0&&t[n].addedNodes.forEach(function(t){1===t.nodeType&&t.matches("[x-data]")&&e(t)})}).observe(t,{childList:!0,attributes:!0,subtree:!0})},initializeComponent:function(e){e.__x=new o(e)}};e()||(window.Alpine=a,window.Alpine.start());export default a;
//# sourceMappingURL=alpine.mjs.map
