(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2571],{15255:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/identity",function(){return n(89942)}])},43267:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var i=n(39324),o=n(4337),a=n(35250),s=n(6038),r=n(52696),d=n(80479),c=n(15329),l=n(1821),u=n(82277),f=n(13090),m=n(32877),p=n(78931),g=n(16266),h=n(77311),v=n(19841),x=n(60554),b=n(70079),y=n(1454),j=n(32004),M=n(94968);function k(){var e=(0,o._)(["max-w-5xl mx-auto w-full"]);return k=function(){return e},e}function I(e){var t=e.route,n=e.children,i=(0,x.useRouter)();return(0,a.jsx)(c.ZB,{$as:"button",className:(0,v.default)("rounded",i.route!==t&&"hover:bg-token-surface-secondary dark:hover:bg-gray-800"),onClick:function(){i.push(t)},children:n})}function w(e){var t=e.workspaceName,n=e.hasAdminPrivileges,o=e.hasOwnerPrivileges,r=(0,p.hz)(),d=(0,x.useRouter)(),c=(0,b.useCallback)(function(){d.push("/")},[d]);return(0,a.jsxs)("nav",{className:"p-2",children:[(0,a.jsxs)("div",{className:"mb-1 flex flex-row gap-2",children:[(0,a.jsxs)(f.MP,{onClick:c,children:[(0,a.jsx)(y.Ao2,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.backToChat))]}),(0,a.jsx)(f.H,{})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[(0,a.jsxs)("div",{className:"my-2 flex flex-col gap-2 px-2",children:[(0,a.jsx)(s.B0,{size:"large"}),(0,a.jsx)("h2",{className:"text-lg text-token-text-primary dark:text-white",children:t})]}),(0,a.jsxs)(I,{route:"/admin",children:[(0,a.jsx)(g.Z,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.membersPageTitle))]}),n&&(0,a.jsxs)(I,{route:"/admin/analytics",children:[(0,a.jsx)(y.orK,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.analytics))]}),o&&(0,a.jsxs)(I,{route:"/admin/billing",children:[(0,a.jsx)(y.XiQ,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.billing))]}),o&&r.has(m.L0.WorkspaceAdminSettings)&&(0,a.jsxs)(I,{route:"/admin/settings",children:[(0,a.jsx)(y.nbt,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.settings))]}),o&&(0,a.jsxs)(I,{route:"/admin/identity",children:[(0,a.jsx)(h.Z,{className:"icon-sm"}),(0,a.jsx)(j.Z,(0,i._)({},N.identity))]})]})]})}function T(e){var t=e.mobilePageTitle,n=e.requireAdminPrivileges,o=void 0!==n&&n,s=e.children,c=(0,p.ec)(function(e){return e.currentWorkspace}),f=(0,p.$T)(),m=(0,r.Ix)(c),g=(0,x.useRouter)(),h=null!=c?(0,d.$v)(c.role):void 0,v=null!=c?(0,d.Di)(c.role):void 0;return(0,b.useEffect)(function(){o&&!1===h&&g.push("/admin")},[o,h,g]),(0,a.jsx)(u.Z,{showNavigation:!0,renderTitle:t,renderSidebar:(0,a.jsx)(w,{workspaceName:f?"":m,hasAdminPrivileges:h,hasOwnerPrivileges:v}),children:(0,a.jsxs)(S,{children:[f&&(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)(l.Z,{})}),!f&&!c&&(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)(j.Z,(0,i._)({},N.workspaceNotFound))}),!f&&c&&s]})})}var S=n(21389).Z.div(k()),N=(0,M.vU)({workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found",description:"The title of the admin page."},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat",description:"Navigation button to return to main chat page"},membersPageTitle:{id:"adminPage.membersPageTitle",defaultMessage:"Members",description:"The title of the members page"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics",description:"Analytics sidebar item"},billing:{id:"adminPage.billing",defaultMessage:"Billing Info",description:"Billing sidebar item"},settings:{id:"adminPage.Settings",defaultMessage:"Settings",description:"Settings sidebar item"},identity:{id:"adminPage.identity",defaultMessage:"Identity & Provisioning",description:"Identity sidebar item"}})},89942:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return eb},default:function(){return ey}});var i,o,a,s,r,d,c=n(39324),l=n(35250),u=n(22830),f=n(75641),m=n(70079);let p=m.forwardRef(function({title:e,titleId:t,...n},i){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{d:"M6.25 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM3.25 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM19.75 7.5a.75.75 0 00-1.5 0v2.25H16a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H22a.75.75 0 000-1.5h-2.25V7.5z"}))}),g=m.forwardRef(function({title:e,titleId:t,...n},i){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{fillRule:"evenodd",d:"M12.516 2.17a.75.75 0 00-1.032 0 11.209 11.209 0 01-7.877 3.08.75.75 0 00-.722.515A12.74 12.74 0 002.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 00.374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 00-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08zm3.094 8.016a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"}))});var h=n(77311),v=n(19841),x=n(73413),b=n.n(x),y=n(32004),j=n(70671),M=n(94968),k=n(67273),I=n(1821),w=n(97674),T=n(96237),S=n(92720),N=n(55629),C=n(1454),L=n(21722),P=n(38104);let E=m.forwardRef(function({title:e,titleId:t,...n},i){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},n),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))});var _=n(11084),A=function(e){var t=e.label,n=e.showOnHover,i=e.value,o=e.onCopied,a=function(){(0,_.S)(i),o()};return(0,l.jsxs)("div",{className:"flex flex-col space-y-2 text-gray-700 dark:text-gray-200",children:[void 0!==t&&(0,l.jsx)("label",{className:"font-medium",children:t}),(0,l.jsxs)("div",{className:"flex items-center justify-between space-x-2",children:[(0,l.jsx)("div",{onClick:a,className:(0,v.default)("flex-1 cursor-pointer rounded-lg border border-gray-300 bg-white p-2 dark:bg-gray-700",n?"truncate hover:overflow-visible hover:whitespace-normal":""),children:i}),(0,l.jsx)("div",{onClick:a,className:"cursor-pointer p-1 hover:bg-gray-100",children:(0,l.jsx)(E,{className:"h-5 w-5"})})]})]})},D=n(79579),Z=n(89368),R=n(51973),O=n(88798),B=n(95137),F=n(13995),W=n(74686);function U(e){var t,n,i=e.workspaceId,o=e.isOpen,a=e.onClose,r=e.domain,d=(0,j.Z)(),p=(t=(0,F.NL)(),(0,W.D)({mutationFn:function(e){var t=e.hostname;return B.ZP.addDomainToWorkspace(i,t)},onSuccess:function(){t.invalidateQueries({queryKey:["workspace/identity",i]})}})).mutateAsync,g=(n=(0,F.NL)(),(0,W.D)({mutationFn:function(e){var t=e.domainId;return B.ZP.checkDomainForWorkspace(i,t)},onSuccess:function(){n.invalidateQueries({queryKey:["workspace/identity",i]})}})).mutateAsync,h=(0,u._)((0,m.useState)(null==r?void 0:r.hostname),2),v=h[0],x=h[1],b=(0,u._)((0,m.useState)(null==r?void 0:r.dns_verification_token_string),2),M=b[0],k=b[1],I=(0,u._)((0,m.useState)(),2),w=I[0],T=I[1],S=(0,u._)((0,m.useState)((null==r?void 0:r.status)===void 0?s.INITIAL:(null==r?void 0:r.status)===f.pT.PENDING?s.PENDING:s.FINAL),2),N=S[0],E=S[1],_=(0,u._)((0,m.useState)(null==r?void 0:r.id),2),U=_[0],V=_[1],z=function(){r||(V(void 0),k(void 0),x(void 0),E(s.INITIAL)),T(void 0)},H=(0,l.jsx)(D.ZP.Button,{title:d.formatMessage(X.check),color:"primary",disabled:void 0===v,onClick:(0,L._)(function(){var e;return(0,P.Jh)(this,function(t){switch(t.label){case 0:if(!(void 0!==U))return[3,2];return[4,g({domainId:U})];case 1:"error"in(e=t.sent())&&T(d.formatMessage(X.domainCheckError)),"id"in e&&e.status===f.pT.VERIFIED&&E(s.FINAL),t.label=2;case 2:return[2]}})})}),G=(0,l.jsx)(D.ZP.Button,{title:d.formatMessage(X.submit),color:"primary",disabled:void 0===v,onClick:(0,L._)(function(){var e;return(0,P.Jh)(this,function(t){switch(t.label){case 0:if(void 0===v)return[2];return[4,p({hostname:v})];case 1:return"error"in(e=t.sent())&&T(e.error.message),"id"in e&&(k(e.dns_verification_token_string),V(e.id)),E(s.PENDING),[2]}})})}),q=(0,l.jsx)(D.ZP.Button,{title:d.formatMessage(X.done),color:"primary",onClick:function(){z(),a()}});return(0,l.jsx)(Z.Z,{isOpen:o,onClose:a,type:"success",title:d.formatMessage(N===s.INITIAL?X.newTitle:X.editTitle),primaryButton:N===s.INITIAL?G:N===s.PENDING?H:q,secondaryButton:(0,l.jsx)(D.ZP.Button,{title:d.formatMessage(X.cancel),color:"light",onClick:function(){z(),a()}}),children:N===s.INITIAL?(0,l.jsxs)("form",{children:[void 0!==w&&(0,l.jsxs)("div",{className:"mt-2 flex w-full items-center bg-red-100 p-3",children:[(0,l.jsx)(C.BJv,{className:"icon-sm mr-2 text-red-400"}),(0,l.jsx)("div",{className:"flex-grow-0 text-xs text-red-700",children:w})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"mb-2 flex items-center text-sm",children:(0,l.jsx)(y.Z,(0,c._)({},X.domainInput))}),(0,l.jsx)(R.Z,{name:"hostname",placeholder:d.formatMessage(X.placeholder),value:null!=v?v:"",onChange:function(e){x(e.target.value)}})]})]}):N===s.PENDING?(0,l.jsxs)("div",{className:"mb-4 text-gray-500 dark:text-gray-400",children:[(0,l.jsx)("div",{children:d.formatMessage(X.verificationTokenMessage,{hostname:v})}),(0,l.jsx)("div",{className:"my-4 font-medium",children:(0,l.jsx)(A,{value:M,onCopied:function(){O.m.success(d.formatMessage(X.copiedTXTRecordToClipboard),{duration:3})}})}),(0,l.jsx)("div",{children:d.formatMessage(X.verificationTokenFooter)}),void 0!==w&&(0,l.jsxs)("div",{className:"mt-2 flex w-full items-center bg-red-100 p-3",children:[(0,l.jsx)(C.BJv,{className:"icon-sm mr-2 text-red-400"}),(0,l.jsx)("div",{className:"flex-grow-0 text-xs text-red-700",children:w})]})]}):(0,l.jsxs)("div",{className:"mb-4 text-gray-500 dark:text-gray-400",children:[(0,l.jsx)("div",{children:d.formatMessage(X.successfulVerification,{hostname:v})}),(0,l.jsx)("div",{className:"my-4 font-medium",children:(0,l.jsx)(A,{value:M,onCopied:function(){O.m.success(d.formatMessage(X.copiedTXTRecordToClipboard),{duration:3})}})})]})})}(i=s||(s={}))[i.INITIAL=0]="INITIAL",i[i.PENDING=1]="PENDING",i[i.FINAL=2]="FINAL";var X=(0,M.vU)({newTitle:{id:"domainModal.newTitle",defaultMessage:"New Domain",description:"The title for the domain modal in new mode."},editTitle:{id:"domainModal.editTitle",defaultMessage:"Manage Domain",description:"The title for the domain modal in edit mode."},submit:{id:"domainModal.submit",defaultMessage:"Submit",description:"The label for the submit button."},check:{id:"domainModal.check",defaultMessage:"Check",description:"The label for the check button."},done:{id:"domainModal.done",defaultMessage:"Done",description:"The label for the done button."},cancel:{id:"domainModal.cancel",defaultMessage:"Cancel",description:"The label for the cancel button."},domainInput:{id:"domainModal.domainInput",defaultMessage:"Hostname",description:"The label for the domain input."},placeholder:{id:"domainModal.placeholder",defaultMessage:"openai.com",description:"The placeholder text domain input."},domainCheckError:{id:"domainModal.domainCheckError",defaultMessage:"Your domain could not be verified. Make sure you've correctly set the TXT record above. DNS records may take up to 30 minutes to propagate.",description:"Error message when domain cannot be successfully verified."},verificationTokenMessage:{id:"domainModal.verificationTokenMessage",defaultMessage:"To verify ownership of {hostname}, navigate to your DNS provider and add a TXT record with this value:",description:"Message that informs the user how to verify their domain."},verificationTokenFooter:{id:"domainModal.verificationTokenFooter",defaultMessage:"Then, check the record to complete the verification.",description:"Message that informs the user how to verify their domain."},successfulVerification:{id:"domainModal.successfulVerification",defaultMessage:"{hostname} has been successfully verified!",description:"Message showing the user their domain verification is complete.."},copiedTXTRecordToClipboard:{id:"domainModal.copiedTXTRecordToClipboard",defaultMessage:"Copied DNS TXT record to clipboard",description:"Message informing the user their TXT record has been copied."}}),V=n(4337),z=n(5268),H=n(21389);function G(){var e=(0,V._)(["font-medium text-xl text-gray-700 dark:text-gray-200"]);return G=function(){return e},e}function q(){var e=(0,V._)(["my-8 rounded-lg space-y-6"]);return q=function(){return e},e}function J(){var e=(0,V._)(["text-lg font-medium text-gray-700 dark:text-gray-200"]);return J=function(){return e},e}function K(){var e=(0,V._)(["text-md mb-4 text-gray-600 dark:text-gray-300"]);return K=function(){return e},e}function Q(){var e=(0,V._)(["border-gray-100 dark:border-gray-600"]);return Q=function(){return e},e}function $(e){var t=e;return t.startsWith("-----BEGIN")||(t="-----BEGIN CERTIFICATE-----\n".concat(t)),t.endsWith("CERTIFICATE-----")||(t="".concat(t,"\n-----END CERTIFICATE-----")),t}function Y(e){var t=(0,F.NL)();return(0,W.D)({mutationFn:function(t){var n=t.connectionId,i=t.signInEndpoint,o=t.cert,a=t.active,s=t.enforcedClients;return B.ZP.updateSAMLConnection(e,n,{signInEndpoint:i,cert:void 0!==o?$(o):void 0,active:a,enforcedClients:s})},onSuccess:function(){t.refetchQueries({queryKey:["workspace/identity",e]})}})}var ee=H.Z.div(G()),et=H.Z.div(q()),en=H.Z.div(J()),ei=H.Z.div(K()),eo=H.Z.hr(Q()),ea=(r={},(0,T._)(r,f.pT.VERIFIED,"Verified"),(0,T._)(r,f.pT.PENDING,"Pending"),(0,T._)(r,f.pT.EXPIRED,"Expired"),r),es={autoProvisionEnabledToast:{id:"workspaceIdentity.autoProvisionEnabledToast",defaultMessage:"Auto provisioning enabled for this workspace",description:"Toast message for enabling auto provisioning"},autoProvisionDisabledToast:{id:"workspaceIdentity.autoProvisionDisabledToast",defaultMessage:"Auto provisioning disabled for this workspace",description:"Toast message for disabling auto provisioning"}};function er(e){var t=e.onRemoveDomainClick,n=e.onVerifyDomainClick;return(0,l.jsxs)(S.Z.Root,{children:[(0,l.jsx)(S.Z.Trigger,{children:(0,l.jsx)(C.K9M,{className:"icon-sm"})}),(0,l.jsx)(S.Z.Portal,{children:(0,l.jsxs)(S.Z.Content,{children:[(0,l.jsx)(S.Z.Item,{onClick:t,children:(0,l.jsx)(y.Z,(0,c._)({},ec.ssoDropdownRemoveButtonText))}),(0,l.jsx)(S.Z.Item,{onClick:n,children:(0,l.jsx)(y.Z,(0,c._)({},ec.ssoDropdownVerifyButtonText))})]})})]})}function ed(e){var t,n=e.domains,i=e.workspaceId,o=(t=(0,F.NL)(),(0,W.D)({mutationFn:function(e){var t=e.domainId;return B.ZP.removeDomainFromWorkspace(i,t)},onSuccess:function(){t.refetchQueries({queryKey:["workspace/identity",i]})}})).mutateAsync,a=(0,u._)((0,m.useState)({}),2),s=a[0],r=a[1],d=(0,u._)((0,m.useState)(!1),2),f=d[0],p=d[1];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(N.Z.Root,{className:"w-full table-auto",children:[(0,l.jsx)("thead",{className:"border-b border-gray-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 text-left font-light",children:(0,l.jsx)(y.Z,(0,c._)({},ec.domainTableHeader))}),(0,l.jsx)("th",{className:"py-2 text-left font-light",children:(0,l.jsx)(y.Z,(0,c._)({},ec.statusTableHeader))}),(0,l.jsx)("th",{className:"py-2"})]})}),(0,l.jsx)("tbody",{children:n.map(function(e,t){return(0,l.jsxs)("tr",{onClick:function(){return r((0,T._)({},t,!0))},className:"cursor-pointer",children:[(0,l.jsx)("td",{className:"border-t border-gray-200 py-2 dark:border-gray-600",children:e.hostname}),(0,l.jsx)("td",{className:"border-t border-gray-200 py-2 dark:border-gray-600",children:(0,l.jsx)("span",{className:"flex items-center",children:ea[e.status]})}),(0,l.jsx)("td",{className:"w-min border-t border-gray-200 py-2 text-right dark:border-gray-600",children:(0,l.jsx)("div",{onClick:function(e){return e.stopPropagation()},children:(0,l.jsx)(er,{onRemoveDomainClick:function(){o({domainId:e.id})},onVerifyDomainClick:function(){r((0,T._)({},t,!0))}})})}),(0,l.jsx)("div",{onClick:function(e){return e.stopPropagation()},children:(0,l.jsx)(U,{isOpen:s[t],onClose:function(){var e=(0,c._)({},s);delete e[t],r(e)},workspaceId:i,domain:e})})]},t)})})]}),(0,l.jsx)("button",{className:"mt-6 font-medium text-gray-800 dark:text-gray-200",onClick:function(){p(!0)},children:(0,l.jsx)(y.Z,(0,c._)({},ec.addDomainButton))}),(0,l.jsx)(U,{isOpen:f,onClose:function(){return p(!1)},workspaceId:i})]})}var ec={ssoDropdownRemoveButtonText:{id:"workspaceIdentity.ssoDropdownRemoveButtonText",defaultMessage:"Remove Domain",description:"Dropdown choice for remove domain"},ssoDropdownVerifyButtonText:{id:"workspaceIdentity.ssoDropdownVerifyButtonText",defaultMessage:"Verify",description:"Dropdown choice to bring up the verification modal"},domainTableHeader:{id:"workspaceIdentity.domainTableHeader",defaultMessage:"Domain",description:"Label for domain column on domains table"},statusTableHeader:{id:"workspaceIdentity.statusTableHeader",defaultMessage:"Status",description:"Label for status column on domains table"},addDomainButton:{id:"workspaceIdentity.addDomainButton",defaultMessage:"+ Add domain",description:"Label for add domain button"}},el=(o=(0,L._)(function(e){return(0,P.Jh)(this,function(t){return[2,new Promise(function(t,n){var i=new FileReader;i.readAsText(e),i.onload=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},i.onerror=n})]})}),function(e){return o.apply(this,arguments)});function eu(e){var t=e.acsId,n=e.hasSSO,i="".concat(location.host,"/auth/login?sso=true&connection=").concat(t),o=(0,j.Z)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ei,{children:(0,l.jsx)(y.Z,(0,c._)({},em.setupSSOContent))}),(0,l.jsxs)("div",{className:"mb-6 flex flex-col space-y-4",children:[(0,l.jsx)(A,{label:o.formatMessage(em.acsURLLabel),value:"https://auth0.openai.com/login/callback?connection=".concat(t),onCopied:function(){O.m.success(o.formatMessage(em.copiedACSToClipboard),{duration:3})}}),(0,l.jsx)(A,{label:o.formatMessage(em.entityIDLabel),value:"urn:auth0:openai:".concat(t),onCopied:function(){O.m.success(o.formatMessage(em.copiedEntityToClipboard),{duration:3})}}),n&&(0,l.jsx)(A,{label:o.formatMessage(em.idpSignInURL),value:i,onCopied:function(){O.m.success(o.formatMessage(em.copiedIDPUrlToClipboard),{duration:3})}})]})]})}function ef(e){var t,n,i,o,a=e.workspaceId,s=e.data,r=e.isOpen,f=e.onClose,p=(0,j.Z)(),g=(t=(0,F.NL)(),(0,W.D)({mutationFn:function(e){var t=e.signInEndpoint,n=e.cert;return B.ZP.createSAMLConnection(a,t,$(n))},onSuccess:function(){t.refetchQueries({queryKey:["workspace/identity",a]})}})).mutateAsync,h=(n=(0,F.NL)(),(0,W.D)({mutationFn:function(e){var t=e.connectionId;return B.ZP.deleteSAMLConnection(a,t)},onSuccess:function(){n.refetchQueries({queryKey:["workspace/identity",a]})}})).mutateAsync,x=Y(a).mutateAsync,b=(0,m.useRef)(null),M=null==s?void 0:s.connection,I=(0,u._)((0,m.useState)(null==M?void 0:M.sign_in_endpoint),2),w=I[0],T=I[1],S=(0,u._)((0,m.useState)(null==M?void 0:M.cert),2),N=S[0],E=S[1],_=null===s?d.CREATE:d.EDIT,A=(i=(0,L._)(function(e,t){return(0,P.Jh)(this,function(n){switch(n.label){case 0:return[4,g({signInEndpoint:e,cert:t})];case 1:return[4,x({connectionId:n.sent().id,active:!0})];case 2:return n.sent(),f(),[2]}})}),function(e,t){return i.apply(this,arguments)}),O=_===d.CREATE?(0,l.jsx)(D.ZP.Button,{title:p.formatMessage(em.doneButton),color:"primary",disabled:void 0===w||void 0===N,onClick:(0,L._)(function(){return(0,P.Jh)(this,function(e){switch(e.label){case 0:if(void 0===w||void 0===N)return[2];return[4,A(w,N)];case 1:return e.sent(),[2]}})})}):s&&(0,l.jsx)(D.ZP.Button,{title:p.formatMessage(em.doneButton),color:"primary",onClick:(0,L._)(function(){return(0,P.Jh)(this,function(e){switch(e.label){case 0:return[4,x({connectionId:null==s?void 0:s.id,cert:N,signInEndpoint:w,active:!0})];case 1:return e.sent(),f(),[2]}})})}),U=null===s?(0,l.jsx)(D.ZP.Button,{title:p.formatMessage(em.cancelButton),color:"light",onClick:function(){return f()}}):(0,l.jsx)(k.z,{as:"link",color:"danger",className:"bg-transparent font-bold text-red-500 hover:bg-transparent",onClick:(0,L._)(function(){return(0,P.Jh)(this,function(e){switch(e.label){case 0:return[4,h({connectionId:null==s?void 0:s.id})];case 1:return e.sent(),f(),[2]}})}),children:p.formatMessage(em.deleteButton)});return(0,l.jsx)(Z.Z,{isOpen:r,type:"success",title:p.formatMessage(_===d.CREATE?em.createTitle:em.editTitle),primaryButton:O,secondaryButton:U,onClose:f,children:(0,l.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[(0,l.jsx)(ei,{children:(0,l.jsx)(y.Z,(0,c._)({},em.createInstructionsManual))}),(0,l.jsx)("label",{className:"mb-2 flex items-center text-sm",children:(0,l.jsx)(y.Z,(0,c._)({},em.signInLabel))}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)(R.Z,{className:"w-full appearance-none rounded border px-3 py-2",name:"Sign-In URL",type:"text",placeholder:"https://your.idp.here/saml2?idpid=123456",value:null!=w?w:"",onChange:function(e){T(e.target.value)}})}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,l.jsx)("label",{className:"text-sm",children:(0,l.jsx)(y.Z,(0,c._)({},em.certLabel))}),(0,l.jsx)("input",{ref:b,type:"file",accept:".csv,.cer,.pem,text/plain",className:"hidden",onChange:(o=(0,L._)(function(e){var t;return(0,P.Jh)(this,function(n){switch(n.label){case 0:if(!(null===(t=e.target.files)||void 0===t?void 0:t[0]))return[3,2];return[4,el(e.target.files[0])];case 1:E(n.sent()),n.label=2;case 2:return[2]}})}),function(e){return o.apply(this,arguments)})}),(0,l.jsx)(k.z,{color:"light",onClick:function(){return b.current.click()},children:(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)(C.Yjd,{className:"icon-sm"})})})]}),(0,l.jsx)("textarea",{rows:10,className:(0,v.default)("w-full resize-none overflow-y-auto rounded border border-gray-300 px-3 py-2","outline-none focus-within:border-indigo-600 focus-within:ring-1 focus-within:ring-indigo-600","text-gray-900 placeholder-gray-500 dark:bg-gray-700 dark:text-gray-100"),placeholder:"-----BEGIN CERTIFICATE-----",value:null!=N?N:"",onChange:function(e){E(e.target.value)}})]})]})})}(a=d||(d={}))[a.CREATE=1]="CREATE",a[a.EDIT=2]="EDIT";var em=(0,M.vU)({setupSSOContent:{id:"workspaceIdentity.setupSSOContent",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO.",description:"Content describing how SAML SSO will work when set up"},createInstructionsXML:{id:"ssoModal.createInstructionsXML",defaultMessage:"If your Identity Provider offers a metadata URL or an XML file, add it here for the quickest setup option.",description:"Instructions for users to create an SSO connection from an XML configuration that the IDP provides"},createInstructionsManual:{id:"ssoModal.createInstructionsManual",defaultMessage:"Copy your Sign-in endpoint (SSO URL) and the public X.509 certificate from your Identity Provider.",description:"Instructions for users to create an SSO connection from their IDP"},createTitle:{id:"ssoModal.createTitle",defaultMessage:"Create SAML SSO Configuration",description:"The title for the create version of the SSO modal"},editTitle:{id:"ssoModal.editTitle",defaultMessage:"Edit SAML SSO Configuration",description:"The title for the edit version of the SSO modal"},ssoMetadataLabel:{id:"ssoModal.ssoMetadataLabel",defaultMessage:"App Federation Metadata URL",description:"The label for the IDP XML metadata URL input"},signInLabel:{id:"ssoModal.signInLabel",defaultMessage:"SSO URL",description:"The label for the sign in endpoint input"},certLabel:{id:"ssoModal.certLabel",defaultMessage:"X.509 Signing Certificate",description:"The label for the X.509 signing certificate input"},doneButton:{id:"ssoModal.doneButton",defaultMessage:"Done",description:"The text for the done button on the SSO modal"},nextButton:{id:"ssoModal.nextButton",defaultMessage:"Next",description:"The text for the next button on the SSO modal"},deleteButton:{id:"ssoModal.deleteButton",defaultMessage:"Delete configuration",description:"The text for the delete button on the SSO modal"},cancelButton:{id:"ssoModal.cancelButton",defaultMessage:"Cancel",description:"The text for the cancel button on the SSO modal"},acsURLLabel:{id:"workspaceIdentity.acsURLLabel",defaultMessage:"Assertion Consumer Service (ACS) URL",description:"Label for the ACS URL configuration text"},entityIDLabel:{id:"workspaceIdentity.entityIDLabel",defaultMessage:"Entity ID",description:"Label for the Entity ID configuration text"},idpSignInURL:{id:"workspaceIdentity.idpSignInURL",defaultMessage:"IDP Tile URL",description:"Label for the IDP Tile URL configuration text"},copiedACSToClipboard:{id:"workspaceIdentity.copiedACSToClipboard",defaultMessage:"Copied ACS URL to clipboard",description:"Message for success toast on copying post-back url"},copiedEntityToClipboard:{id:"workspaceIdentity.copiedEntityToClipboard",defaultMessage:"Copied entity ID to clipboard",description:"Message for success toast on copying entity ID"},copiedIDPUrlToClipboard:{id:"workspaceIdentity.copiedIDPUrlToClipboard",defaultMessage:"Copied IDP URL to clipboard",description:"Message for success toast on copying IDP URL"},orDivider:{id:"workspaceIdentity.orDivider",defaultMessage:"or",description:"Separator between the top and bottom portions of the form"},certExtractFailed:{id:"workspaceIdentity.certExtractFailed",defaultMessage:"Unable to find X.509 Certificate in provided XML",description:"Notice to the user that the given XML did not contain a certificate"},ssoUrlExtractFailed:{id:"workspaceIdentity.ssoUrlExtractFailed",defaultMessage:"Unable to find Entity ID (sign-in endpoint) in provided XML",description:"Notice to the user that the given XML did not contain an entity ID"},ssoLearnMoreLink:{id:"workspaceIdentity.ssoLearnMoreLink",defaultMessage:"Learn more",description:"Label for link to learn more"}}),ep=function(e){var t=e.title,n=e.footer,i=e.children;return(0,l.jsxs)(et,{children:[(0,l.jsx)(ee,{children:(0,l.jsx)(y.Z,(0,c._)({},t))}),(0,l.jsx)("div",{className:"container mx-auto my-6",children:i}),(0,l.jsx)(ei,{children:n})]})},eg=function(e){var t=e.icon,n=e.title,i=e.body,o=e.toggle;return(0,l.jsxs)(et,{children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"mr-2",children:(0,l.jsx)(t,{className:"icon-sm"})}),(0,l.jsx)(en,{children:(0,l.jsx)(y.Z,(0,c._)({},n))})]}),(0,l.jsx)("div",{children:o})]}),(0,l.jsx)(ei,{children:i})]})};function eh(e){var t,n,i,o,a,s=e.currentWorkspaceId,r=(0,j.Z)(),d=(0,z.a)({queryKey:["workspace/identity",s],queryFn:(0,L._)(function(){return(0,P.Jh)(this,function(e){switch(e.label){case 0:return[4,B.ZP.getWorkspaceIdentitySettings(s)];case 1:return[2,e.sent()]}})})}).data,x=Y(s).mutateAsync,M=(t=(0,j.Z)(),(0,W.D)({mutationFn:function(e){var n=e.shouldAutoProvision;return B.ZP.setWorkspaceShouldAutoProvision(s,n).then(function(e){var i=n?es.autoProvisionEnabledToast:es.autoProvisionDisabledToast;return O.m.success(t.formatMessage(i),{duration:3}),e}).catch(function(e){throw O.m.danger(e.message),e})}})),T=M.variables,S=M.mutateAsync,N=(null==d?void 0:d.sso_connection)!==null,C=null==d?void 0:d.domains.some(function(e){return e.status===f.pT.VERIFIED}),E=N?ev.ssoEditButton:ev.ssoAddButton,_=(0,u._)((0,m.useState)(!1),2),A=_[0],D=_[1],Z=(null==d?void 0:null===(n=d.sso_connection)||void 0===n?void 0:n.status)==="ACTIVE",R=null==d?void 0:null===(i=d.sso_connection)||void 0===i?void 0:i.id;return d?(0,l.jsxs)("div",{className:"mx-auto max-w-xl px-4 py-8",children:[(0,l.jsx)(b(),{children:(0,l.jsx)("title",{children:r.formatMessage(ev.title)})}),(0,l.jsx)("div",{className:"mb-10 text-center text-2xl font-medium",children:(0,l.jsx)(y.Z,(0,c._)({},ev.title))}),(0,l.jsx)(eo,{}),(0,l.jsx)(ep,{title:ev.domainSubtitle,footer:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(y.Z,(0,c._)({},ev.verifyDomainInfoText))}),children:(0,l.jsx)(ed,{domains:d.domains,workspaceId:s})}),(0,l.jsx)(eo,{}),(0,l.jsx)(eg,{icon:p,title:ev.autoProvisionTitle,body:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(y.Z,(0,c._)({},ev.autoProvisionBody))}),toggle:(0,l.jsx)(w.Z,{disabled:!C,enabled:null!==(a=null==T?void 0:T.shouldAutoProvision)&&void 0!==a?a:d.should_auto_provision,onChange:function(e){S({shouldAutoProvision:e})},label:r.formatMessage(ev.toggleAutoProvisionLabel)})}),(0,l.jsx)(eo,{}),(0,l.jsxs)(et,{children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"mr-2",children:(0,l.jsx)(g,{className:(0,v.default)("icon-sm",Z?"text-blue-600":"text-gray-400")})}),(0,l.jsx)(ee,{children:(0,l.jsx)(y.Z,(0,c._)({},ev.ssoTitle))})]}),N&&(0,l.jsx)("div",{children:(0,l.jsx)(w.Z,{enabled:Z,onChange:function(){x({connectionId:R,active:!Z})},label:r.formatMessage(ev.ssoToggleActive)})})]}),C&&(0,l.jsx)(eu,{acsId:d.acs_id,hasSSO:N}),(0,l.jsxs)("div",{children:[(0,l.jsx)(k.z,{as:"button",color:"primary",disabled:!C,onClick:function(){D(!0)},className:"font-medium",children:(0,l.jsx)(y.Z,(0,c._)({},E))}),(0,l.jsx)(ef,{workspaceId:s,data:d.sso_connection,isOpen:A,onClose:function(){return D(!1)}})]})]}),(0,l.jsx)(eo,{}),d.sso_connection&&(0,l.jsx)(eg,{icon:h.Z,title:ev.enforceSSOTitle,body:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(y.Z,(0,c._)({},ev.enforceSSOBody))}),toggle:(0,l.jsx)(w.Z,{disabled:!C,enabled:null===(o=d.sso_connection.auth0_enforced_clients)||void 0===o?void 0:o.includes("chat"),onChange:function(e){x({connectionId:d.sso_connection.id,enforcedClients:e?["chat"]:[]})},label:r.formatMessage(ev.enforceSSOLabel)})})]}):(0,l.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,l.jsx)(I.Z,{})})}var ev=(0,M.vU)({title:{id:"workspaceIdentity.title",defaultMessage:"Identity & Provisioning",description:"Title of identity page"},domainSubtitle:{id:"workspaceIdentity.domainSubtitle",defaultMessage:"Domain management",description:"Section header of domain management"},ssoTitle:{id:"workspaceIdentity.ssoTitle",defaultMessage:"Single Sign On",description:"Section title of SSO"},ssoToggleActive:{id:"WorkspaceIdentityPage.ssoToggleActive",defaultMessage:"Enable SSO for this workspace",description:"Label for toggle to activate SSO"},ssoAddButton:{id:"workspaceIdentity.ssoAddButton",defaultMessage:"Add SAML SSO",description:"Label for add SSO button"},ssoEditButton:{id:"workspaceIdentity.ssoEditButton",defaultMessage:"Edit SAML SSO",description:"Label for edit SSO button"},autoProvisionTitle:{id:"workspaceIdentity.autoProvisionSubtitle",defaultMessage:"Automatic account creation",description:"Subtitle for auto provisioning"},autoProvisionBody:{id:"workspaceIdentity.autoProvisionBody",defaultMessage:"Automatically create ChatGPT Enterprise accounts for new users who log in with a verified domain.",description:"Label for toggling automatic provisioning"},toggleAutoProvisionLabel:{id:"workspaceIdentity.toggleAutoProvisionLabel",defaultMessage:"Toggle to enable or disable auto provisioning",description:"Label for auto provisioning toggle"},enforceSSOTitle:{id:"workspaceIdentity.enforceSSOTitle",defaultMessage:"Enforce SSO log in",description:"Section title for toggling SSO enforcement"},enforceSSOBody:{id:"workspaceIdentity.enforceSSOBody",defaultMessage:"When SSO is active, users will no longer be able to use social logins and will be redirected to your SSO portal.",description:"Message telling users what enforcing SSO will do"},enforceSSOLabel:{id:"workspaceIdentity.enforceSSOLabel",defaultMessage:"Toggle to enable or disable SSO enforcement",description:"Label for toggle for SSO enforcement"},verifyDomainInfoText:{id:"workspaceIdentity.verifyDomainInfoText",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on.",description:"Informational text for domain verification section"},learnMoreLink:{id:"workspaceIdentity.learnMoreLink",defaultMessage:"Learn more",description:"Label for link to learn more"}}),ex=n(43267),eb=!0;function ey(e){return(0,l.jsx)(eh,(0,c._)({},e))}ey.getLayout=function(e){return(0,l.jsx)(ex.default,{mobilePageTitle:"Identity",children:e})}},52696:function(e,t,n){"use strict";n.d(t,{$3:function(){return f},Ap:function(){return c},CV:function(){return m},GA:function(){return u},Gk:function(){return v},Ix:function(){return g},_O:function(){return h},bE:function(){return x},cI:function(){return p},qH:function(){return l}});var i=n(96237),o=n(75641),a=n(78931),s=n(62509),r=n(70079),d=n(70671);function c(){var e=(0,d.Z)(),t=e.formatMessage(b.adminRoleName),n=e.formatMessage(b.ownerRoleName),a=e.formatMessage(b.standardRoleName);return(0,r.useMemo)(function(){var e;return e={},(0,i._)(e,o.r3.OWNER,n),(0,i._)(e,o.r3.ADMIN,t),(0,i._)(e,o.r3.STANDARD,a),e},[n,t,a])}function l(e){var t=(0,d.Z)();return e?e.structure===o.CZ.PERSONAL?t.formatMessage(b.personalPlanName):t.formatMessage(b.enterprisePlanName):t.formatMessage(b.personalPlanName)}function u(e){return m((0,d.Z)(),e)}function f(){var e=(0,a.ec)(function(e){return e.currentWorkspace});return m((0,d.Z)(),e)}function m(e,t){var n;return t&&t.structure!==o.CZ.PERSONAL?null!==(n=t.name)&&void 0!==n?n:e.formatMessage(b.defaultWorkspaceTitle):e.formatMessage(b.personalWorkspaceTitle)}function p(){var e,t,n,i,o=(0,s.kP)().session;return null!==(i=null!==(n=null==o?void 0:null===(e=o.user)||void 0===e?void 0:e.name)&&void 0!==n?n:null==o?void 0:null===(t=o.user)||void 0===t?void 0:t.email)&&void 0!==i?i:null}function g(e){var t=(0,a.ec)(function(e){return e.currentWorkspace}),n=(0,a.ec)(a.F_.isPersonalWorkspace),i=(0,a.$T)(),s=u(t),r=p();return e&&!i?e.structure===o.CZ.PERSONAL?r:e.name:t?n?r:s:r}function h(){return(0,a.ec)(function(e){return e.workspaces})}function v(e){var t=h().find(function(t){return t.id===e});return(null==t?void 0:t.role)===o.r3.OWNER}function x(e){var t=h().find(function(t){return t.id===e});return(null==t?void 0:t.role)===o.r3.ADMIN}var b=(0,n(94968).vU)({defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace",description:"title for workspace without a name"},personalWorkspaceTitle:{id:"useWorkspaces.personalWorkspaceTitle",defaultMessage:"Personal account",description:"title for personal workspace"},personalPlanName:{id:"useWorkspaces.personalPlanName",defaultMessage:"Personal",description:"label for personal tier account"},enterprisePlanName:{id:"useWorkspaces.enterprisePlanName",defaultMessage:"Enterprise",description:"label for enterprise tier account"},adminRoleName:{id:"useWorkspaces.adminRoleName",defaultMessage:"Admin",description:"Role name for an admin user"},ownerRoleName:{id:"useWorkspaces.ownerRoleName",defaultMessage:"Owner",description:"Role name for an owner user"},standardRoleName:{id:"useWorkspacews.standardRoleName",defaultMessage:"Member",description:"Role name for a standard user"}})},16266:function(e,t,n){"use strict";var i=n(70079);let o=i.forwardRef(function({title:e,titleId:t,...n},o){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":t},n),e?i.createElement("title",{id:t},e):null,i.createElement("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",clipRule:"evenodd"}))});t.Z=o}},function(e){e.O(0,[2104,2277,9774,2888,179],function(){return e(e.s=15255)}),_N_E=e.O()}]);