(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3264],{64641:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/templates/editor",function(){return n(94670)}])},94670:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return et},default:function(){return en}});var r=n(35250),a=n(75641),s=n(21722),o=n(39324),i=n(71209),l=n(22830),c=n(4337),u=n(38104),d=n(37469),m=n(78931),h=n(6013),g=n(35427),x=n(19841),v=n(60554),f=n(70079),p=n(1454),b=n(21389),y=n(67273),j=n(79579),_=n(89368),k=n(1821),w=n(88798),N=n(42569),C=n(53776),T=n(36338),I=n(64082),S=n(95954),P=n(58914),Z=n(80479),O=n(61888),W=n(95342),M=f.memo(function(e){var t=e.playgroundTemplate,n=e.clientThreadId,a=e.onInitiated;(0,d.ax)(n);var s=(0,d.UL)(n),o=(0,d.oq)(n),i=(0,d.JI)(n,o).some(function(e){return e.role===S.uU.User});(0,T.BZ)(n,t.config.assistant_welcome_message),(0,f.useEffect)(function(){i&&a()},[i,a]),(0,f.useEffect)(function(){var e=(0,Z.jh)(t.config.enabled_tools);!(0,d.Zz)(n)||s.lastModelUsed===t.config.model_slug&&(0,O.isEqual)(s.pluginIds,e)||d.tQ.updateInitialThreadDataForNewThread(n,t.config.model_slug,e)},[n,s.lastModelUsed,s.pluginIds,t.config.model_slug,t.config.enabled_tools]);var l=(0,f.useMemo)(function(){return{playgroundTemplate:t}},[t]);return(0,r.jsx)(P.h.Provider,{value:l,children:(0,r.jsx)(W.Z,{initialThreadData:s,clientThreadId:n})})});function z(){var e=(0,c._)(["block font-medium text-lg text-token-text-primary"]);return z=function(){return e},e}function D(){var e=(0,c._)(["mb-4"]);return D=function(){return e},e}function E(){var e=(0,c._)(["w-full resize-none overflow-y-auto rounded border bg-transparent px-3 py-2 focus:ring-2 focus:ring-blue-400 dark:border-gray-900 dark:bg-gray-700"]);return E=function(){return e},e}function A(){var e=(0,c._)(["text-sm text-red-500"]);return A=function(){return e},e}function B(e){var t=e.icon,n=e.color,a=e.setIcon,s=e.setColor;return(0,r.jsxs)("div",{className:"my-1 rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900",children:[(0,r.jsx)("div",{className:"my-1.5 grid grid-cols-5 justify-items-center gap-3 border-b border-gray-200 px-4 py-4 dark:border-gray-700",children:T.nm.map(function(e){var t=(0,T.uJ)(e);return(0,r.jsxs)("button",{className:"relative h-6 w-6",onClick:function(){s(e)},children:[(0,r.jsx)("div",{className:"h-full w-full rounded",style:{backgroundColor:(0,T.uJ)(e)},children:(0,r.jsx)("div",{className:(0,x.default)("flex cursor-pointer flex-col items-center justify-center rounded p-2")},e)}),(0,r.jsx)("div",{className:(0,x.default)("absolute inset-0 rounded outline outline-2 outline-offset-2",e===n?"opacity-100":"opacity-0 hover:opacity-20"),style:{outlineColor:t}})]},e)})}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-3 p-4",children:T.Ap.map(function(e){var n=(0,T.i_)(e);return(0,r.jsx)("div",{className:(0,x.default)("flex cursor-pointer flex-col items-center justify-center rounded p-1.5 text-gray-800 hover:bg-gray-100 hover:text-black dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white",e===t?"bg-gray-100 text-black dark:bg-gray-700 dark:text-white":""),onClick:function(){a(e)},children:(0,r.jsx)(n,{className:"icon-lg"})},e)})})]})}function L(e){var t=e.icon,n=e.color,a=e.setIcon,s=e.setColor,o=(0,T.i_)(t);return(0,r.jsxs)(h.fC,{children:[(0,r.jsx)(h.xz,{asChild:!0,children:(0,r.jsxs)("button",{className:"relative overflow-hidden rounded",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-20",style:{backgroundColor:(0,T.uJ)(n)}}),(0,r.jsxs)("div",{className:"relative flex text-white",children:[(0,r.jsx)("div",{className:"rounded p-1.5",style:{backgroundColor:(0,T.uJ)(n)},children:(0,r.jsx)(o,{className:"icon-lg"})}),(0,r.jsx)("div",{className:"flex items-center",style:{color:(0,T.uJ)(n)},children:(0,r.jsx)(p.bTu,{className:"icon-sm"})})]})]})}),(0,r.jsx)(h.h_,{children:(0,r.jsx)(h.VY,{sideOffset:0,align:"start",children:(0,r.jsx)(B,{icon:t,color:n,setIcon:a,setColor:s})})})]})}var q=b.Z.label(z()),J=b.Z.div(D());function U(e){var t=e.value,n=e.icon,a=e.label;return(0,r.jsxs)(g.ck,{value:t,className:"inline-flex items-center gap-2 bg-gray-100 px-3 py-2 text-sm radix-state-checked:bg-green-600 radix-state-checked:text-white dark:bg-gray-500 dark:radix-state-checked:bg-green-600",children:[(0,r.jsx)(n,{className:"icon-sm"}),a]})}function R(e){var t=e.value,n=e.onValueChange;return(0,r.jsxs)(g.fC,{value:t,onValueChange:n,className:"inline-flex overflow-hidden rounded",children:[(0,r.jsx)(U,{value:T.Ou.Private,icon:p.UIZ,label:"Private"}),(0,r.jsx)(U,{value:T.Ou.Published,icon:p._rq,label:"Published"})]})}function V(e){var t=e.onDelete,n=e.onClose;return(0,r.jsx)(_.Z,{isOpen:!0,onClose:n,type:"danger",title:"Delete chat template",primaryButton:(0,r.jsx)(j.ZP.Button,{title:"Delete template",color:"danger",onClick:function(){t()}}),secondaryButton:(0,r.jsx)(j.ZP.Button,{title:"Cancel",color:"neutral",onClick:n}),children:(0,r.jsx)("div",{className:"text-sm",children:"Are you sure you want to delete this template? This cannot be undone."})})}function F(e){var t=e.workspaceId,n=e.conversationTemplate,a=(0,T.Zv)(t),o=(0,l._)((0,f.useState)(!1),2),i=o[0],c=o[1],d=(0,v.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(y.z,{type:"button",onClick:function(){c(!0)},disabled:a.isLoading,color:"danger-outline",children:[(0,r.jsx)(p.Ybf,{className:"icon-sm"}),"Delete template"]}),i&&(0,r.jsx)(V,{onDelete:(0,s._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:return[4,a.mutateAsync({conversationTemplateId:n.id})];case 1:return e.sent(),w.m.success("Chat template deleted",{duration:3}),d.push("/templates",void 0,{shallow:!0}),[2]}})}),onClose:function(){c(!1)}})]})}function G(e){var t,n,a,o,i,c,d=e.conversationTemplate,m=e.workspaceId,h=e.configContextMessage,g=e.setConfigContextMessage,x=e.configAssistantWelcomeMessage,p=e.setConfigAssistantWelcomeMessage,b=e.onNewPlaygroundConversation,j=(0,v.useRouter)(),_=(0,l._)((0,f.useState)(null!==(t=null==d?void 0:d.name)&&void 0!==t?t:""),2),k=_[0],N=_[1],C=(0,l._)((0,f.useState)(null!==(n=null==d?void 0:d.icon)&&void 0!==n?n:T.bj.Box),2),I=C[0],S=C[1],P=(0,l._)((0,f.useState)(null!==(a=null==d?void 0:d.color)&&void 0!==a?a:(0,T.yq)()),2),Z=P[0],O=P[1],W=(0,l._)((0,f.useState)(null!==(o=null==d?void 0:d.config.context_message)&&void 0!==o?o:""),2),M=W[0],z=W[1],D=(0,l._)((0,f.useState)(null!==(i=null==d?void 0:d.config.assistant_welcome_message)&&void 0!==i?i:""),2),E=D[0],A=D[1],B=(0,l._)((0,f.useState)((null==d?void 0:d.published_at)!=null?T.Ou.Published:T.Ou.Private),2),U=B[0],V=B[1],G=(0,l._)((0,f.useState)(null!==(c=null==d?void 0:d.description)&&void 0!==c?c:""),2),H=G[0],Y=G[1],$=U===T.Ou.Published&&(null==d?void 0:d.published_at)==null,Q=(0,T.jc)(m),ee=(0,T.h$)(m),et=k.length>T.h5,en=H.length>T.Ip;function er(){return(er=(0,s._)(function(){var e,t;return(0,u.Jh)(this,function(n){switch(n.label){case 0:if(e={name:k,description:H,config:{contextMessage:M,assistantWelcomeMessage:E},publish:U===T.Ou.Published,icon:I,color:Z,profilePicId:void 0},!(null!=d))return[3,2];return t=M!==d.config.context_message,[4,ee.mutateAsync({conversationTemplateId:d.id,templateData:e},{onSuccess:function(){j.push("/?".concat(T.t9,"=").concat(d.id),void 0,{shallow:!0}),t?w.m.success($?"Template saved and published. Changes only apply to new chats. Try it out here.":"Template saved. Changes only apply to new chats. Try it out here.",{duration:3}):w.m.success($?"Template saved and published.":"Template saved.",{duration:3})}})];case 1:return n.sent(),[3,4];case 2:return[4,Q.mutateAsync({templateData:e},{onSuccess:function(e){j.push("/?".concat(T.t9,"=").concat(e.id),void 0,{shallow:!0}),w.m.success($?"Template created and published. Try it out here.":"Template created. Try it out here.",{duration:3})}})];case 3:n.sent(),n.label=4;case 4:return[2]}})})).apply(this,arguments)}return(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsxs)("div",{className:"grow overflow-auto px-10 py-6 md:py-10 lg:px-16",children:[(0,r.jsxs)(J,{children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,r.jsx)(L,{icon:I,color:Z,setIcon:S,setColor:O}),(0,r.jsx)(q,{children:"Template name"})]}),(0,r.jsx)("input",{type:"text",className:"w-full resize-none overflow-y-auto rounded border bg-transparent px-3 py-2 outline-none focus:border-brand-green focus:ring-2 focus:ring-blue-400 dark:border-gray-900 dark:bg-gray-700",placeholder:"Short descriptive name",value:null!=k?k:"",onChange:function(e){return N(e.target.value)}}),et?(0,r.jsxs)(K,{className:"mt-1",children:["Template names cannot be longer than"," ",T.h5," characters."]}):null]}),(0,r.jsxs)(J,{children:[(0,r.jsx)(q,{children:"Instructions"}),(0,r.jsx)("div",{className:"text-md mb-2 text-token-text-secondary",children:"How should this template respond?"}),(0,r.jsx)(X,{rows:8,placeholder:"Give your template access to any content it should use to answer questions. What should your template do? What makes it special?",value:M,onChange:function(e){return z(e.target.value)},onBlurCapture:function(){M.trim()!==h.trim()&&(g(M),b())}}),(0,r.jsx)("div",{className:"text-token-text-tertiary",children:"Tip: You can include extra information that ChatGPT will draw on when responding."})]}),(0,r.jsxs)(J,{children:[(0,r.jsx)(q,{children:"Welcome Message"}),(0,r.jsx)("div",{className:"text-md mb-2 text-token-text-secondary",children:"How should the chat begin?"}),(0,r.jsx)(X,{rows:8,placeholder:"Hi! What's up?",value:E,onChange:function(e){return A(e.target.value)},onBlurCapture:function(){E.trim()!==x.trim()&&(p(E),b())}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-3 text-lg font-medium",children:"Sharing"}),(0,r.jsx)(R,{value:U,onValueChange:V}),(0,r.jsx)("div",{className:"mb-2 mt-3 text-xs text-token-text-secondary",children:U===T.Ou.Private?"This template can only be used by you.":"This template can be used by anyone in this workspace."}),U===T.Ou.Published&&(0,r.jsxs)(J,{className:"mt-4",children:[(0,r.jsx)(q,{children:"Description"}),(0,r.jsx)("div",{className:"text-md mb-2 text-token-text-secondary",children:"A publicly visible blurb about this template."}),(0,r.jsx)("textarea",{value:H,rows:5,placeholder:"What can this template do? What kinds of questions should users ask?",onChange:function(e){return Y(e.target.value)},className:"w-full resize-none overflow-y-auto rounded border bg-transparent px-3 py-2 focus:ring-2 focus:ring-blue-400 dark:border-gray-900 dark:bg-gray-700"}),en?(0,r.jsxs)(K,{className:"mt-1",children:["Template descriptions cannot be longer than"," ",T.Ip," characters."]}):null]}),null!=d&&(0,r.jsx)(J,{className:"mt-8",children:(0,r.jsx)(F,{workspaceId:m,conversationTemplate:d})})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"space-x-2 px-10 py-4 text-right lg:px-16",children:[(0,r.jsx)(y.z,{color:"neutral",as:"button",onClick:function(e){e.preventDefault(),j.back()},children:"Cancel"}),(0,r.jsx)(y.z,{loading:Q.isLoading||ee.isLoading,onClick:function(){return er.apply(this,arguments)},className:"cursor-pointer",disabled:Q.isLoading||ee.isLoading||Q.isSuccess||ee.isSuccess||""===k||""===M||et||en,children:null!=d?$?"Save and publish template":"Save template":$?"Create and publish template":"Create template"})]})})]})}var X=b.Z.textarea(E()),H=function(e){var t,n,a=e.workspace,s=e.conversationTemplate,c=(0,v.useRouter)(),u=(0,l._)((0,f.useState)(function(){return(0,d.OX)()}),2),m=u[0],h=u[1],g=(0,l._)((0,f.useState)(null!==(t=null==s?void 0:s.config.context_message)&&void 0!==t?t:""),2),x=g[0],b=g[1],y=(0,l._)((0,f.useState)(!0),2),j=y[0],_=y[1],k=(0,l._)((0,f.useState)(null!==(n=null==s?void 0:s.config.assistant_welcome_message)&&void 0!==n?n:""),2),w=k[0],T=k[1],I=(0,f.useMemo)(function(){return(0,i._)((0,o._)({},C.W),{id:void 0,config:{context_message:x,assistant_welcome_message:w,model_slug:N.S0,plugin_ids:[],enabled_tools:[]}})},[x,w]),S=(0,f.useCallback)(function(){_(!1)},[]);return(0,r.jsxs)("div",{className:"flex h-screen flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"max-md:px-8 max-md:py-4 flex justify-between bg-gray-800 px-10 py-6 lg:px-16",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"max-md:text-lg text-xl font-medium text-white",children:void 0!==s?"Edit your template":"Create a template"}),(0,r.jsx)("div",{className:"max-md:text-sm text-gray-400",children:"Design a custom chat experience where you guide how ChatGPT responds."})]}),(0,r.jsx)("button",{className:"cursor-pointer text-gray-200",onClick:function(e){e.preventDefault(),c.back()},children:(0,r.jsx)(p.q5L,{className:"icon-lg"})})]}),(0,r.jsxs)("div",{className:"flex grow overflow-hidden",children:[(0,r.jsx)("div",{className:"relative grow dark:bg-gray-900",children:(0,r.jsx)(G,{conversationTemplate:s,workspaceId:a.id,configContextMessage:x,setConfigContextMessage:b,configAssistantWelcomeMessage:w,setConfigAssistantWelcomeMessage:T,onNewPlaygroundConversation:function(){h((0,d.OX)()),_(!0)}})}),(0,r.jsx)("div",{className:"relative hidden w-1/2 flex-shrink-0 bg-gray-50 dark:bg-gray-700 md:block",children:(0,r.jsxs)("div",{className:"max-lg:inset-10 absolute inset-12 overflow-auto rounded-xl bg-token-surface-primary shadow-lg dark:border dark:border-token-border-light dark:bg-gray-800",children:[(0,r.jsx)(M,{playgroundTemplate:I,clientThreadId:m,onInitiated:S},m),j&&(0,r.jsxs)("div",{className:"max-md:left-6 max-md:right-6 absolute inset-y-1/2 left-16 right-16 flex h-fit flex-col items-center justify-center space-y-2 rounded border bg-gray-50 px-2 py-4 opacity-80 dark:border-gray-700 dark:bg-gray-900",children:[(0,r.jsx)(p.nrB,{className:"icon-xl"}),(0,r.jsx)("div",{className:"text-center text-lg font-medium text-token-text-primary",children:"Test your template"}),(0,r.jsx)("div",{className:"text-center text-token-text-tertiary",children:"This temporary chat updates every time you modify your template. It won’t be saved in your chat history."})]})]})})]})]})};function Y(e){var t=e.workspace,n=e.conversationTemplateId,a=(0,T.GS)(t.id,n).data,s=(0,m.ec)(m.F_.accountUserId),o=(null==a?void 0:a.owner_id)===s;return(0,f.useEffect)(function(){a&&void 0!==s&&!o&&(0,I.O)(a.id)},[o,s,a]),null!=a&&o?(0,r.jsx)(H,{workspace:t,conversationTemplate:a}):null}function $(e){var t=e.conversationTemplateId,n=(0,m.ec)().currentWorkspace;return null!=n?(0,r.jsx)("div",{children:void 0!=t?(0,r.jsx)(Y,{workspace:n,conversationTemplateId:t}):(0,r.jsx)(H,{workspace:n})}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsx)(k.Z,{})})}var K=b.Z.div(A()),Q=n(32877),ee=n(77010),et=!0;function en(){var e=(0,v.useRouter)(),t=e.query.id,n=(0,m.$T)(),s=(0,m.ec)(function(e){return e.currentWorkspace}),o=(0,m.hz)(),i=o.has(Q.PL);return(0,f.useEffect)(function(){i&&ee.Z.gatherData()},[i]),(0,f.useEffect)(function(){n||(null==s?void 0:s.structure)===a.CZ.WORKSPACE&&o.has(Q.L0.WorkspaceConversationTemplates)||e.push("/")},[n,s,o,e]),null!==s&&o.has(Q.L0.WorkspaceConversationTemplates)?(0,r.jsx)($,{conversationTemplateId:t}):null}},50744:function(e,t,n){"use strict";var r=n(35250),a=n(55344),s=n.n(a);n(70079);var o=function(e){var t=e.children;return(0,r.jsx)(r.Fragment,{children:t})};t.Z=s()(function(){return Promise.resolve(o)},{ssr:!1})},53776:function(e,t,n){"use strict";n.d(t,{W:function(){return a},x:function(){return s}});var r=n(42569),a={id:void 0,name:"",owner_id:"",author_name:void 0,description:null,published_at:void 0,icon:void 0,color:void 0,updated_at:void 0,profile_pic_id:void 0,profile_pic_permalink:void 0,config:{context_message:"",model_slug:r.S0,assistant_welcome_message:void 0,enabled_tools:void 0}},s={id:void 0,name:"",owner_id:"",author_name:void 0,description:null,published_at:void 0,icon:void 0,color:void 0,updated_at:void 0,profile_pic_id:void 0,profile_pic_permalink:void 0,config:{context_message:"",model_slug:r.dO,assistant_welcome_message:void 0,enabled_tools:void 0}}},42271:function(e,t,n){"use strict";n.d(t,{O:function(){return i},h:function(){return l}});var r=n(4337),a=n(21389);function s(){var e=(0,r._)(["flex p-3 items-center gap-3 transition-colors duration-200 text-gray-600 dark:text-gray-200 cursor-pointer text-sm rounded-md bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 h-11"]);return s=function(){return e},e}function o(){var e=(0,r._)(["h-11 w-11"]);return o=function(){return e},e}var i=a.Z.button(s()),l=a.Z.div(o())},15329:function(e,t,n){"use strict";n.d(t,{R:function(){return v},Vq:function(){return f},ZB:function(){return g},ZP:function(){return h},zV:function(){return x}});var r=n(4337),a=n(35250),s=n(7813),o=n(19841),i=n(21389);function l(){var e=(0,r._)(["p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer"]);return l=function(){return e},e}function c(){var e=(0,r._)(["flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm"]);return c=function(){return e},e}function u(){var e=(0,r._)(["rounded-md border dark:border-white/20 gizmo:min-h-0 hover:bg-gray-500/10 h-11 gizmo:h-10 gizmo:rounded-lg gizmo:border-[rgba(0,0,0,0.1)]"]);return u=function(){return e},e}function d(){var e=(0,r._)(["my-1.5 h-px dark:bg-white/20 bg-black/20"]);return d=function(){return e},e}function m(){var e=(0,r._)(["",""]);return m=function(){return e},e}function h(e){var t=e.onClick,n=e.href,r=e.target,i=e.children;return(0,a.jsx)(s.v.Item,{children:function(e){var s=e.active;return(0,a.jsx)(g,{as:void 0!==n?"a":"button",onClick:t,href:n,target:r,className:(0,o.default)(s?"bg-gray-100 dark:bg-gray-800":"hover:bg-gray-100 dark:hover:bg-gray-800"),children:i})}})}i.Z.a(l());var g=i.Z.a(c()),x=(0,i.Z)(g)(u()),v=i.Z.div(d()),f=(0,i.Z)(g)(m(),function(e){return e.$active?"bg-gray-100 dark:bg-gray-800":"hover:bg-gray-100 dark:hover:bg-gray-800"})}},function(e){e.O(0,[6786,3656,5960,2104,7985,4137,5427,8937,5342,9774,2888,179],function(){return e(e.s=64641)}),_N_E=e.O()}]);