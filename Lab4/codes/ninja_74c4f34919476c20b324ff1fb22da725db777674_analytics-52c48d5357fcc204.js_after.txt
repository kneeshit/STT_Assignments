(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{88289:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/analytics",function(){return t(42532)}])},43267:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return M}});var a=t(39324),r=t(4337),n=t(35250),i=t(6038),o=t(52696),l=t(80479),c=t(15329),u=t(1821),d=t(82277),m=t(13090),f=t(32877),g=t(78931),p=t(16266),x=t(77311),v=t(19841),h=t(60554),k=t(70079),y=t(1454),b=t(32004),j=t(94968);function w(){var e=(0,r._)(["max-w-5xl mx-auto w-full"]);return w=function(){return e},e}function N(e){var s=e.route,t=e.children,a=(0,h.useRouter)();return(0,n.jsx)(c.ZB,{$as:"button",className:(0,v.default)("rounded",a.route!==s&&"hover:bg-token-surface-secondary dark:hover:bg-gray-800"),onClick:function(){a.push(s)},children:t})}function _(e){var s=e.workspaceName,t=e.hasAdminPrivileges,r=e.hasOwnerPrivileges,o=(0,g.hz)(),l=(0,h.useRouter)(),c=(0,k.useCallback)(function(){l.push("/")},[l]);return(0,n.jsxs)("nav",{className:"p-2",children:[(0,n.jsxs)("div",{className:"mb-1 flex flex-row gap-2",children:[(0,n.jsxs)(m.MP,{onClick:c,children:[(0,n.jsx)(y.Ao2,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.backToChat))]}),(0,n.jsx)(m.H,{})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[(0,n.jsxs)("div",{className:"my-2 flex flex-col gap-2 px-2",children:[(0,n.jsx)(i.B0,{size:"large"}),(0,n.jsx)("h2",{className:"text-lg text-token-text-primary dark:text-white",children:s})]}),(0,n.jsxs)(N,{route:"/admin",children:[(0,n.jsx)(p.Z,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.membersPageTitle))]}),t&&(0,n.jsxs)(N,{route:"/admin/analytics",children:[(0,n.jsx)(y.orK,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.analytics))]}),r&&(0,n.jsxs)(N,{route:"/admin/billing",children:[(0,n.jsx)(y.XiQ,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.billing))]}),r&&o.has(f.L0.WorkspaceAdminSettings)&&(0,n.jsxs)(N,{route:"/admin/settings",children:[(0,n.jsx)(y.nbt,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.settings))]}),r&&(0,n.jsxs)(N,{route:"/admin/identity",children:[(0,n.jsx)(x.Z,{className:"icon-sm"}),(0,n.jsx)(b.Z,(0,a._)({},A.identity))]})]})]})}function M(e){var s=e.mobilePageTitle,t=e.requireAdminPrivileges,r=void 0!==t&&t,i=e.children,c=(0,g.ec)(function(e){return e.currentWorkspace}),m=(0,g.$T)(),f=(0,o.Ix)(c),p=(0,h.useRouter)(),x=null!=c?(0,l.$v)(c.role):void 0,v=null!=c?(0,l.Di)(c.role):void 0;return(0,k.useEffect)(function(){r&&!1===x&&p.push("/admin")},[r,x,p]),(0,n.jsx)(d.Z,{showNavigation:!0,renderTitle:s,renderSidebar:(0,n.jsx)(_,{workspaceName:m?"":f,hasAdminPrivileges:x,hasOwnerPrivileges:v}),children:(0,n.jsxs)(P,{children:[m&&(0,n.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,n.jsx)(u.Z,{})}),!m&&!c&&(0,n.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,n.jsx)(b.Z,(0,a._)({},A.workspaceNotFound))}),!m&&c&&i]})})}var P=t(21389).Z.div(w()),A=(0,j.vU)({workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found",description:"The title of the admin page."},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat",description:"Navigation button to return to main chat page"},membersPageTitle:{id:"adminPage.membersPageTitle",defaultMessage:"Members",description:"The title of the members page"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics",description:"Analytics sidebar item"},billing:{id:"adminPage.billing",defaultMessage:"Billing Info",description:"Billing sidebar item"},settings:{id:"adminPage.Settings",defaultMessage:"Settings",description:"Settings sidebar item"},identity:{id:"adminPage.identity",defaultMessage:"Identity & Provisioning",description:"Identity sidebar item"}})},42532:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSP:function(){return E},default:function(){return I}});var a=t(39324),r=t(35250),n=t(21722),i=t(22830),o=t(4337),l=t(38104),c=t(95137),u=t(5268),d=t(65998),m=t(77997),f=t(73413),g=t.n(f),p=t(70079),x=t(25771),v=t(70671),h=t(32004),k=t(94968),y=t(21389),b=t(1821);function j(){var e=(0,o._)(["mb-12 grid grid-cols-1 rounded-lg overflow-hidden border border-token-border-light sm:grid-cols-2"]);return j=function(){return e},e}function w(){var e=(0,o._)(["font-medium"]);return w=function(){return e},e}function N(){var e=(0,o._)(["font-medium text-3xl"]);return N=function(){return e},e}function _(){var e=(0,o._)(["text-sm text-token-text-tertiary"]);return _=function(){return e},e}function M(e){return P.apply(this,arguments)}function P(){return(P=(0,n._)(function(e){var s,t;return(0,l.Jh)(this,function(a){return(s=(0,i._)(e.queryKey,2))[0],t=s[1].workspaceId,[2,c.ZP.getWorkspaceAnalytics(t)]})})).apply(this,arguments)}function A(e){var s=e.data,t=e.label,a=e.getWeekValue,n=(0,v.Z)(),i=(0,m.F)().theme,o=(0,p.useMemo)(function(){var e;return{animation:!1,scales:{y:{position:"right",beginAtZero:!0,ticks:{stepSize:3,color:(e=getComputedStyle(document.body)).getPropertyValue("--text-tertiary"),padding:12},grid:{tickLength:0,color:e.getPropertyValue("--border-medium")},border:{display:!1}},x:{grid:{display:!1},ticks:{color:e.getPropertyValue("--text-tertiary"),padding:20}}},plugins:{legend:!1,tooltip:{backgroundColor:e.getPropertyValue("--surface-primary"),titleColor:e.getPropertyValue("--text-primary"),bodyColor:e.getPropertyValue("--text-secondary"),displayColors:!1,padding:{top:8,left:8,right:8,bottom:8}}}}},[i]),l=(0,p.useMemo)(function(){return getComputedStyle(document.body).getPropertyValue("--text-secondary")},[i]),c={labels:s.weekly_data.map(function(e){return n.formatDate(e.week,{month:"numeric",day:"numeric"})}),datasets:[{label:t,data:s.weekly_data.map(a),borderWidth:0,backgroundColor:l,barThickness:20}]};return(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-token-surface-secondary p-4",children:(0,r.jsx)(x.$Q,{options:o,data:c,height:192})})}function L(e){var s=e.label,t=e.value;return(0,r.jsxs)("div",{className:"w-1/3 rounded bg-gray-50 px-4 py-2 dark:bg-gray-700",children:[(0,r.jsx)("label",{className:"text-sm text-token-text-secondary",children:s}),(0,r.jsx)("div",{className:"text-xl font-medium text-token-text-primary",children:t})]})}function Z(e){var s=e.data,t=(0,v.Z)(),n=s.weekly_data[s.weekly_data.length-2];return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-2 font-medium text-token-text-primary",children:(0,r.jsx)(h.Z,(0,a._)({},U.totals))}),(0,r.jsxs)("div",{className:"mb-16 flex gap-4",children:[(0,r.jsx)(L,{label:t.formatMessage(U.usersLabel),value:s.total_users}),(0,r.jsx)(L,{label:t.formatMessage(U.conversationsLabel),value:s.total_conversations}),(0,r.jsx)(L,{label:t.formatMessage(U.messagesLabel),value:s.total_messages})]}),(0,r.jsxs)(T,{children:[(0,r.jsx)("div",{className:"flex flex-col justify-between p-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(W,{children:(0,r.jsx)(h.Z,(0,a._)({},U.usageTitle))}),null!=n&&(0,r.jsxs)("div",{children:[(0,r.jsx)(C,{children:n.message_count}),(0,r.jsx)(R,{children:(0,r.jsx)(h.Z,(0,a._)({},U.messagesLastWeek))})]})]})}),(0,r.jsx)("div",{children:(0,r.jsx)(A,{data:s,label:t.formatMessage(U.messagesChartLabel),getWeekValue:function(e){return e.message_count}})})]}),(0,r.jsxs)(T,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(A,{data:s,label:t.formatMessage(U.activeUsersChartLabel),getWeekValue:function(e){return e.active_users_count}})}),(0,r.jsx)("div",{className:"flex grow flex-col justify-between p-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(W,{children:(0,r.jsx)(h.Z,(0,a._)({},U.weeklyUsersTitle))}),null!=n&&(0,r.jsxs)("div",{children:[(0,r.jsx)(C,{children:n.active_users_count}),(0,r.jsx)(R,{children:(0,r.jsx)(h.Z,(0,a._)({},U.activeUsersLastWeek))})]})]})})]})]})}d.kL.register(d.uw,d.f$,d.od,d.ZL,d.Dx,d.u,d.De);var T=y.Z.div(j()),W=y.Z.div(w()),C=y.Z.div(N()),R=y.Z.div(_());function S(e){var s=e.currentWorkspaceId,t=(0,v.Z)(),n=(0,u.a)(["workspace-analytics",{workspaceId:s}],M).data;return(0,r.jsxs)("div",{className:"mx-auto max-w-3xl px-4 py-8",children:[(0,r.jsx)(g(),{children:(0,r.jsx)("title",{children:t.formatMessage(U.title)})}),(0,r.jsxs)("div",{className:"mb-12",children:[(0,r.jsx)("div",{className:"text-2xl font-medium text-token-text-primary",children:(0,r.jsx)(h.Z,(0,a._)({},U.title))}),(0,r.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,r.jsx)(h.Z,(0,a._)({},U.pageDescription))})]}),void 0!==n?(0,r.jsx)(Z,{data:n}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsx)(b.Z,{})})]})}var U=(0,k.vU)({title:{id:"workspaceAnalytics.title",defaultMessage:"Workspace Analytics",description:"Title of analytics page"},pageDescription:{id:"workspaceAnalytics.understand",defaultMessage:"Understand how your workspace is using ChatGPT",description:"Subtext of workspace analytics page"},totals:{id:"workspaceAnalytics.totals",defaultMessage:"Totals over last 30 days",description:"Section header of total analytics"},usersLabel:{id:"workspaceAnalytics.usersLabel",defaultMessage:"Users",description:"Label of total user count"},conversationsLabel:{id:"workspaceAnalytics.conversationsLabel",defaultMessage:"Conversations",description:"Label of total conversations count"},messagesLabel:{id:"workspaceAnalytics.messagesLabel",defaultMessage:"Messages",description:"Label of total messages count"},usageTitle:{id:"workspaceAnalytics.usageTitle",defaultMessage:"Usage",description:"Title of usage section"},messagesLastWeek:{id:"workspaceAnalytics.messagesLastWeek",defaultMessage:"Messages processed last week",description:"Text under number messages last week"},messagesLast30Days:{id:"workspaceAnalytics.messagesLast30Days",defaultMessage:"{count, plural, =0 {No messages} one {# message} other {# messages}} processed over last 30 days",description:"Analytics text about messages"},messagesChartLabel:{id:"workspaceAnalytics.messagesChartLabel",defaultMessage:"Messages",description:"Label for messages chart"},weeklyUsersTitle:{id:"workspaceAnalytics.weeklyUsersTitle",defaultMessage:"Weekly users",description:"Title of weekly users section"},activeUsersChartLabel:{id:"workspaceAnalytics.activeUsersChartLabel",defaultMessage:"Active users",description:"Label for active users chart"},activeUsersLastWeek:{id:"workspaceAnalytics.activeUsersLastWeek",defaultMessage:"Active users last week",description:"Text under number active users last week"},usersLast30Days:{id:"workspaceAnalytics.usersLast30Days",defaultMessage:"{count, plural, =0 {No active users} one {# active user} other {# active user}} over last 30 days",description:"Analytics text about active users"}}),D=t(43267),E=!0;function I(e){return(0,r.jsx)(S,(0,a._)({},e))}I.getLayout=function(e){return(0,r.jsx)(D.default,{mobilePageTitle:"Analytics",requireAdminPrivileges:!0,children:e})}},52696:function(e,s,t){"use strict";t.d(s,{$3:function(){return m},Ap:function(){return c},CV:function(){return f},GA:function(){return d},Gk:function(){return v},Ix:function(){return p},_O:function(){return x},bE:function(){return h},cI:function(){return g},qH:function(){return u}});var a=t(96237),r=t(75641),n=t(78931),i=t(62509),o=t(70079),l=t(70671);function c(){var e=(0,l.Z)(),s=e.formatMessage(k.adminRoleName),t=e.formatMessage(k.ownerRoleName),n=e.formatMessage(k.standardRoleName);return(0,o.useMemo)(function(){var e;return e={},(0,a._)(e,r.r3.OWNER,t),(0,a._)(e,r.r3.ADMIN,s),(0,a._)(e,r.r3.STANDARD,n),e},[t,s,n])}function u(e){var s=(0,l.Z)();return e?e.structure===r.CZ.PERSONAL?s.formatMessage(k.personalPlanName):s.formatMessage(k.enterprisePlanName):s.formatMessage(k.personalPlanName)}function d(e){return f((0,l.Z)(),e)}function m(){var e=(0,n.ec)(function(e){return e.currentWorkspace});return f((0,l.Z)(),e)}function f(e,s){var t;return s&&s.structure!==r.CZ.PERSONAL?null!==(t=s.name)&&void 0!==t?t:e.formatMessage(k.defaultWorkspaceTitle):e.formatMessage(k.personalWorkspaceTitle)}function g(){var e,s,t,a,r=(0,i.kP)().session;return null!==(a=null!==(t=null==r?void 0:null===(e=r.user)||void 0===e?void 0:e.name)&&void 0!==t?t:null==r?void 0:null===(s=r.user)||void 0===s?void 0:s.email)&&void 0!==a?a:null}function p(e){var s=(0,n.ec)(function(e){return e.currentWorkspace}),t=(0,n.ec)(n.F_.isPersonalWorkspace),a=(0,n.$T)(),i=d(s),o=g();return e&&!a?e.structure===r.CZ.PERSONAL?o:e.name:s?t?o:i:o}function x(){return(0,n.ec)(function(e){return e.workspaces})}function v(e){var s=x().find(function(s){return s.id===e});return(null==s?void 0:s.role)===r.r3.OWNER}function h(e){var s=x().find(function(s){return s.id===e});return(null==s?void 0:s.role)===r.r3.ADMIN}var k=(0,t(94968).vU)({defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace",description:"title for workspace without a name"},personalWorkspaceTitle:{id:"useWorkspaces.personalWorkspaceTitle",defaultMessage:"Personal account",description:"title for personal workspace"},personalPlanName:{id:"useWorkspaces.personalPlanName",defaultMessage:"Personal",description:"label for personal tier account"},enterprisePlanName:{id:"useWorkspaces.enterprisePlanName",defaultMessage:"Enterprise",description:"label for enterprise tier account"},adminRoleName:{id:"useWorkspaces.adminRoleName",defaultMessage:"Admin",description:"Role name for an admin user"},ownerRoleName:{id:"useWorkspaces.ownerRoleName",defaultMessage:"Owner",description:"Role name for an owner user"},standardRoleName:{id:"useWorkspacews.standardRoleName",defaultMessage:"Member",description:"Role name for a standard user"}})}},function(e){e.O(0,[6835,2104,667,2277,9774,2888,179],function(){return e(e.s=88289)}),_N_E=e.O()}]);